import telebot
import random
from telebot import types

import database
from config import TOKEN

bot = telebot.TeleBot(TOKEN)
database.create_table()

compliments = [
    "–¢—ã —Å–µ–≥–æ–¥–Ω—è –≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω–∞ üå∏",
    "–£ —Ç–µ–±—è –æ—Ç–ª–∏—á–Ω—ã–π –≤–∫—É—Å ‚ú®",
    "–¢—ã —É–º–Ω–∏—Ü–∞ üí°",
    "–¢—ã —É–º–Ω–µ–µ, —á–µ–º –¥—É–º–∞–µ—à—å! üß©",
    "–£ —Ç–µ–±—è –æ—Ç–ª–∏—á–Ω–æ–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ üß†",
    "–¢—ã –±—ã—Å—Ç—Ä–æ —Å—Ö–≤–∞—Ç—ã–≤–∞–µ—à—å —Å—É—Ç—å –≤–µ—â–µ–π ‚ö°",
    "–¢—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ —Å–ø—Ä–∞–≤–ª—è–µ—à—å—Å—è —Å —Ç—Ä—É–¥–Ω–æ—Å—Ç—è–º–∏! üõ°Ô∏è",
    "–£ —Ç–µ–±—è —Å–∏–ª—å–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä üí™",
    "–¢—ã –Ω–µ —Å–¥–∞—ë—à—å—Å—è, –¥–∞–∂–µ –∫–æ–≥–¥–∞ —Å–ª–æ–∂–Ω–æ üßó",
    "–¢—ã –¥–µ–ª–∞–µ—à—å —Ä–µ–∞–ª—å–Ω—ã–µ —à–∞–≥–∏ –≤–ø–µ—Ä—ë–¥ üöÄ",
    "–¢—ã —É–º–µ–µ—à—å –¥–æ–≤–æ–¥–∏—Ç—å –¥–µ–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞ ‚úîÔ∏è",
    "–¢—ã –º–Ω–æ–≥–æ–≥–æ —É–∂–µ –¥–æ—Å—Ç–∏–≥–ª–∞, –∏ —ç—Ç–æ –∑–∞–º–µ—Ç–Ω–æ üå±",
    "–° —Ç–æ–±–æ–π –ª–µ–≥–∫–æ –∏ –ø—Ä–∏—è—Ç–Ω–æ –æ–±—â–∞—Ç—å—Å—è üòä",
    "–¢—ã —É–º–µ–µ—à—å —Å–ª—É—à–∞—Ç—å –∏ –ø–æ–Ω–∏–º–∞—Ç—å ü§ù",
    "–¢—ã —Å–æ–∑–¥–∞—ë—à—å —Ç—ë–ø–ª—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –≤–æ–∫—Ä—É–≥ —Å–µ–±—è ‚òÄÔ∏è",
    "–¢—ã —Å–ø—Ä–∞–≤–ª—è–µ—à—å—Å—è –ª—É—á—à–µ, —á–µ–º —Ç–µ–±–µ –∫–∞–∂–µ—Ç—Å—è üíõ",
    "–¢—ã –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—à—å –≥–æ—Ä–¥–∏—Ç—å—Å—è —Å–æ–±–æ–π ‚≠ê",
    "–¢—ã –¥–æ—Å—Ç–æ–π–Ω–∞ —É–≤–∞–∂–µ–Ω–∏—è üëè",
    "–¢—ã –ø–æ–¥–Ω–∏–º–∞–µ—à—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ üåà",
    "–û—Ç —Ç–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—Ç—Å—è –ø–æ–∑–∏—Ç–∏–≤ ‚ú®",
    "–¢—ã –Ω–∞—Å—Ç–æ—è—â–∞—è –º–æ–ª–æ–¥–µ—Ü üôå",
    "–¢—ã —É–Ω–∏–∫–∞–ª—å–Ω–∞ –ø–æ-—Å–≤–æ–µ–º—É üíé",
    "–¢—ã –¥–µ–ª–∞–µ—à—å –º–∏—Ä —á—É—Ç–æ—á–∫—É –ª—É—á—à–µ üåç"
]


def main_keyboard():
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.add("üíñ –ö–æ–º–ø–ª–∏–º–µ–Ω—Ç", "üìú –ò—Å—Ç–æ—Ä–∏—è")
    return keyboard


@bot.message_handler(commands=["start"])
def start(message):
    bot.send_message(
        message.chat.id,
        "–Ø –±–æ—Ç-–∫–æ–º–ø–ª–∏–º–µ–Ω—Ç üíï",
        reply_markup=main_keyboard()
    )


@bot.message_handler(func=lambda m: m.text == "üíñ –ö–æ–º–ø–ª–∏–º–µ–Ω—Ç")
def give_compliment(message):
    text = random.choice(compliments)
    database.save_compliment(message.from_user.id, text)
    bot.send_message(message.chat.id, text)


@bot.message_handler(func=lambda m: m.text == "üìú –ò—Å—Ç–æ—Ä–∏—è")
def show_history(message):
    history_list = database.get_history(message.from_user.id)

    if not history_list:
        bot.send_message(message.chat.id, "–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞")
    else:
        bot.send_message(message.chat.id, "\n".join(history_list))


bot.polling()
